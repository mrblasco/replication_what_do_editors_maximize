---
title: "Replication of What Editors Maximize"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(stargazer)
library(glue)
library(tidyverse)
library(haven)
library(ggplot2)
#library(ggpubr)
#theme_set(theme_pubr())
library(kableExtra) 
#library(faraway)
library(dplyr)
library(scales)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r dataset}
Pooled_cleaned <- read_dta("../original/Data/Main/Pooled_cleaned.dta")

JEEA <- Pooled_cleaned %>% 
  filter(jeea == 1)

QJE <- Pooled_cleaned %>% 
  filter(qje == 1)

REStat <- Pooled_cleaned %>% 
  filter(restat == 1)

REStud <- Pooled_cleaned %>% 
  filter(restud == 1)

pooled_cleaned_all <- Pooled_cleaned %>% mutate(journal = "All")
```

## Including Plots

You can also embed plots, for example:

```{r table1, echo=FALSE}
create_table <- function(temp) { 
  transpose_temp <- temp %>% 
    select(-journal) %>% 
    as.matrix %>% 
    t
  colnames(transpose_temp) <- temp$journal
  return(transpose_temp)
}

mean_rm_na <- function(x) {
  mean(x, na.rm = TRUE)
}

sd_rm_na <- function(x) {
  sd(x, na.rm = TRUE)
}

create_temp <- function(d) {
  d %>% 
    group_by(journal) %>% 
    mutate(year_range = cut(yearsubmit, c(2010, 2012, 2020))) %>% 
    select(GScites, WOScites, authpub5, ndr, rr, auth_count, micro, theory, metrics, macro, internat, fin, pub, labor, healthurblaw, hist, io, dev, lab, other, missingfield, frDefReject, frReject, frNoRec, frWeakRR, frRR, frStrongRR, frAccept,) %>% 
    mutate(GScites_asinh = asinh(GScites)) %>% 
    summarize_if(is.numeric, c("mean" = mean_rm_na, SD = sd_rm_na))  %>% 
    select(names(.) %>% sort)
}

temp_all <- Pooled_cleaned %>% 
  bind_rows(pooled_cleaned_all) %>% 
  create_temp()

temp_no_desk <- Pooled_cleaned %>% 
  filter(decision!="DeskRej") %>% 
  bind_rows(pooled_cleaned_all %>% filter(decision!="DeskRej")) %>% 
  create_temp()

table_left <- create_table(temp_all)
table_right <- create_table(temp_no_desk)

table_1 <- cbind(table_left, table_right) %>% 
  kbl(digits = 1) %>% 
  kable_classic(full = FALSE) %>% 
  add_header_above(c("Variable", "All papers" = 5, "Non desk-rejected" = 5))

table_1
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
